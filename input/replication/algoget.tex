
\footnotesize
\algrenewcommand{\algorithmiccomment}[1]{\hskip2em$\rhd$ #1}

\newcommand{\comment}[1]{$\rhd$ #1}

\newcommand{\LINEFOR}[2]{%
  \algorithmicfor\ {#1}\ \algorithmicdo\ {#2} %
}

\newcommand{\LINEIFTHEN}[2]{%
  \algorithmicif\ {#1}\ \algorithmicthen\ {#2} %
}

\newcommand{\LINEIFTHENELSE}[3]{%
  \algorithmicif\ {#1}\ \algorithmicthen\ {#2} \algorithmicelse\ {#3} %
}

\newcommand{\LET}[2]{%
  \State \textbf{let}\ $#1 \leftarrow #2$%
}

\newcommand{\PIPE}[0]{%
  \,|\,%
}

\newcommand{\INDSTATE}[1][1]{\State\hspace{\algorithmicindent}}

\begin{algorithmic}[1]
  \Function{leftmostBranch}{$t \in \mathcal{T}$}{$\, \rightarrow \mathcal{I}$}
  \State \textbf{let} $\langle \_,\, path,\, \_,\, children \rangle \leftarrow t$;
  \If {$(|children|=0)$}
  \State \Return t;
  \Else
  \State \Return [$path \,|\, \textsc{leftmostBranch}(children[0])$];
  \EndIf
  \EndFunction

  \Statex

  \Function{searchFromLeft}{$t \in \mathcal{T}$, $index \in \mathbb{N}$}{$\, \rightarrow \mathcal{I}$}
  \If{$(index = 0)$}
  \State \Return $\textsc{leftmostBranch}(t)$;
  \Else
  \LET{i}{0};
  \LET {\langle elem,\, path,\, \_,\, children \rangle}{t};
  \State \LINEIFTHEN{$(elem)$}{$index = index + 1$;}
  \LET {\langle elem,\, \_,\, count,\, cOfC \rangle}{children[i]};
  \While {$(index+count)<0$}
  \State \DARKBLUE{$index \leftarrow index + count$}; \label{repl:line:lefttoright}
  \State \LINEIFTHEN {$(elem)$} {$index = index + 1$;}
  \State $i = i+1$;
  \State $\langle elem,\, \_,\, count,\, cOfC \rangle \leftarrow children[i]$;
  \EndWhile
  \State \Return $[path \PIPE \textsc{searchFromLeft}(cOfC[i],\, index)]$;
  \EndIf
  \EndFunction

  \Statex

  \Function{get}{$t \in \mathcal{T},\, index \in \mathbb{N}$}{$\, \rightarrow \mathcal{I}$}
  \State \Return $\textsc{searchFromLeft}(t,\, \DARKBLUE{-index})$;
  \EndFunction

\end{algorithmic}
